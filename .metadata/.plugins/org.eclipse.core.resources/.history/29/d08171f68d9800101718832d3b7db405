// src/main/java/com/example/medicalappointmentsystem/controller/MedicalRecordController.java
package com.example.medicalappointmentsystem.controller;

import com.example.medicalappointmentsystem.model.MedicalRecord;
import com.example.medicalappointmentsystem.repository.MedicalRecordRepository;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/records")
@CrossOrigin(origins = "http://localhost:5173")
public class MedicalRecordController {

    private final MedicalRecordRepository recordRepository;

    public MedicalRecordController(MedicalRecordRepository recordRepository) {
        this.recordRepository = recordRepository;
    }

    // ✅ Add new record
    @PostMapping
    public MedicalRecord createRecord(@RequestBody MedicalRecord record) {
        return recordRepository.save(record);
    }

    // ✅ View all records
    @GetMapping
    public List<MedicalRecord> getAllRecords() {
        return recordRepository.findAll();
    }

    // ✅ Get a single record
    @GetMapping("/{id}")
    public MedicalRecord getRecord(@PathVariable Long id) {
        return recordRepository.findById(id)
                .orElseThrow(() -> new RuntimeException("Record not found with id " + id));
    }
}
